{% extends "../../partials/layout.html" %} 
{% from "../../macros.njk" import submitLink %}
{% from "govuk/components/button/macro.njk" import govukButton %} 
{% from "govuk/components/radios/macro.njk" import govukRadios %} 
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}

{% set pageTitle = 'Staff involved in use of force' %}

{% block content %}
<div class="govuk-grid-row govuk-body">
  {% if errors.length > 0 %}
  {{
    govukErrorSummary({
      titleText: 'There is a problem',
      errorList: errors,
      attributes: { 'data-qa-errors': true }
    })
  }}
  {% endif %}
  <div class="govuk-grid-column-three-quarters govuk-!-margin-bottom-4">
    <h1 class="govuk-heading-xl">{{ pageTitle }}</h1>
  </div>
  <div class="govuk-grid-column-three-quarters">
      <form method="post">
        <input type="hidden" name="_csrf" value="{{ csrfToken }}" />
        <input type="hidden" name="nextDestination" value="{{ data.nextDestination }}" />

        {% set rows = [] %}

        {% for item in staff %}
        {% set rows = (rows.push([
            {
            text: item.name
            },
            {
            text: item.email
            },
            {
            html: '<a class="govuk-link" href="/report/' + bookingId + '/delete-staff-member/' + item.username + '">Delete staff member</a>' if not item.isReporter
            }
        ]), rows) %}
        {% endfor %}

        
        {{ govukTable({
          classes: "added-involved-staff govuk-!-margin-bottom-9",
          head: [
            {
              text: "Name",
              classes: 'govuk-!-width-one-third'
            },
            {
              text: "Email Address",
              classes: 'govuk-!-width-one-third'
            },
            {
              text: "",
              classes: 'govuk-!-width-one-quarter'
            }
          ],
          rows: rows
        }) }}
   
        {{ 
            govukRadios({
                classes: "govuk-radios--inline",
                name: "addMore",
                fieldset: {
                    legend: {
                      text: "Do you want to add another member of staff?",
                      classes: "govuk-fieldset__legend--s"
                    }
                },
                items: [
                {
                    value: "yes",
                    id: "confirm",
                    text: "Yes"
                },
                {
                    value: "no",
                    text: "No"
                }
                ]
            }) 
        }}
    
        {{
            govukButton({
            text: 'Save and continue',
            classes: 'govuk-button',
            attributes: { 'data-qa': 'continue', 'data-submit': true }
            })
        }}

        {% set formName = 'edit-incident-details' if data.nextDestination == 'check-your-answers'  else 'incident-details' %}
        <br/>
        <a class="govuk-body govuk-link govuk-link--no-visited-state" data-value="save-and-return" data-qa="save-and-return" href="/report/{{bookingId}}/report-use-of-force">
          Save and return to report use of force
      </a>
      </form>
  </div>
</div>
{% endblock %}
